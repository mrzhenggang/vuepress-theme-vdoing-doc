<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PETSc 编译安装教程 | Mr.ZhengGang&#39;s blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/mrzhenggang/CDN@master/favicon/favicon.ico">
    <meta name="description" content="超级计算技术博客,简洁至上,专注超级计算领域和高性能计算领域的计数分享。HPC,超算,软件,个人技术博客,高性能计算,技术文档,学习,用户手册等技术文章。">
    <meta name="keywords" content="HPC,超算,软件,个人技术博客,高性能计算,技术文档,学习,用户手册,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.a068838e.css" as="style"><link rel="preload" href="/assets/js/app.69f27ac7.js" as="script"><link rel="preload" href="/assets/js/2.6c62b168.js" as="script"><link rel="preload" href="/assets/js/27.28b186b5.js" as="script"><link rel="prefetch" href="/assets/js/10.679d9bf6.js"><link rel="prefetch" href="/assets/js/11.46728246.js"><link rel="prefetch" href="/assets/js/12.69e0d73c.js"><link rel="prefetch" href="/assets/js/13.d1ed2a1d.js"><link rel="prefetch" href="/assets/js/14.1206fa1a.js"><link rel="prefetch" href="/assets/js/15.86f1c048.js"><link rel="prefetch" href="/assets/js/16.c825da8e.js"><link rel="prefetch" href="/assets/js/17.689ce3b1.js"><link rel="prefetch" href="/assets/js/18.05b7a64d.js"><link rel="prefetch" href="/assets/js/19.ec340bfc.js"><link rel="prefetch" href="/assets/js/20.b106684f.js"><link rel="prefetch" href="/assets/js/21.5f9a971a.js"><link rel="prefetch" href="/assets/js/22.b5d8835b.js"><link rel="prefetch" href="/assets/js/23.eb0be351.js"><link rel="prefetch" href="/assets/js/24.6688b93b.js"><link rel="prefetch" href="/assets/js/25.412c6541.js"><link rel="prefetch" href="/assets/js/26.20fcc8fd.js"><link rel="prefetch" href="/assets/js/28.a97f933e.js"><link rel="prefetch" href="/assets/js/29.452d503b.js"><link rel="prefetch" href="/assets/js/3.77a80601.js"><link rel="prefetch" href="/assets/js/30.3f18f7e0.js"><link rel="prefetch" href="/assets/js/31.53c5e4ba.js"><link rel="prefetch" href="/assets/js/32.d296f731.js"><link rel="prefetch" href="/assets/js/33.e607bcb4.js"><link rel="prefetch" href="/assets/js/34.5ba4c039.js"><link rel="prefetch" href="/assets/js/35.9150837f.js"><link rel="prefetch" href="/assets/js/36.7e03f526.js"><link rel="prefetch" href="/assets/js/37.a17ccc2e.js"><link rel="prefetch" href="/assets/js/38.1c069594.js"><link rel="prefetch" href="/assets/js/39.06cd67d2.js"><link rel="prefetch" href="/assets/js/4.02b89800.js"><link rel="prefetch" href="/assets/js/40.e1b52a74.js"><link rel="prefetch" href="/assets/js/41.1d22c587.js"><link rel="prefetch" href="/assets/js/42.ae00d7c3.js"><link rel="prefetch" href="/assets/js/43.f4833d5e.js"><link rel="prefetch" href="/assets/js/44.5c2e5a95.js"><link rel="prefetch" href="/assets/js/45.3b157c53.js"><link rel="prefetch" href="/assets/js/46.3bc50610.js"><link rel="prefetch" href="/assets/js/47.6d5eb492.js"><link rel="prefetch" href="/assets/js/48.8c7217cc.js"><link rel="prefetch" href="/assets/js/49.a980f7e7.js"><link rel="prefetch" href="/assets/js/5.39919340.js"><link rel="prefetch" href="/assets/js/50.f2484680.js"><link rel="prefetch" href="/assets/js/51.fb018abe.js"><link rel="prefetch" href="/assets/js/52.fc6ac3ff.js"><link rel="prefetch" href="/assets/js/53.c6727139.js"><link rel="prefetch" href="/assets/js/54.db10d71a.js"><link rel="prefetch" href="/assets/js/55.59ac479a.js"><link rel="prefetch" href="/assets/js/56.1514d937.js"><link rel="prefetch" href="/assets/js/57.fd176172.js"><link rel="prefetch" href="/assets/js/58.03f01b6e.js"><link rel="prefetch" href="/assets/js/59.64760478.js"><link rel="prefetch" href="/assets/js/6.dafd6a44.js"><link rel="prefetch" href="/assets/js/60.e9d9ed86.js"><link rel="prefetch" href="/assets/js/61.6406c932.js"><link rel="prefetch" href="/assets/js/62.175d1edd.js"><link rel="prefetch" href="/assets/js/63.3913ad81.js"><link rel="prefetch" href="/assets/js/64.c5486337.js"><link rel="prefetch" href="/assets/js/65.3339eb80.js"><link rel="prefetch" href="/assets/js/66.21ffb109.js"><link rel="prefetch" href="/assets/js/67.f60e2743.js"><link rel="prefetch" href="/assets/js/68.d7cd2e4a.js"><link rel="prefetch" href="/assets/js/69.bbe49457.js"><link rel="prefetch" href="/assets/js/7.7ed9ca3e.js"><link rel="prefetch" href="/assets/js/70.f446af51.js"><link rel="prefetch" href="/assets/js/71.d9832794.js"><link rel="prefetch" href="/assets/js/72.4a84305c.js"><link rel="prefetch" href="/assets/js/73.2c39f02b.js"><link rel="prefetch" href="/assets/js/74.f685d42c.js"><link rel="prefetch" href="/assets/js/75.c28e65f0.js"><link rel="prefetch" href="/assets/js/76.a814975a.js"><link rel="prefetch" href="/assets/js/77.877e4cef.js"><link rel="prefetch" href="/assets/js/78.3937c8ef.js"><link rel="prefetch" href="/assets/js/79.b58cb0f9.js"><link rel="prefetch" href="/assets/js/8.545e10f7.js"><link rel="prefetch" href="/assets/js/80.ae358b5c.js"><link rel="prefetch" href="/assets/js/81.aca62534.js"><link rel="prefetch" href="/assets/js/82.32a8adc1.js"><link rel="prefetch" href="/assets/js/83.1883a8d7.js"><link rel="prefetch" href="/assets/js/84.f9e86ddd.js"><link rel="prefetch" href="/assets/js/85.ad879bc8.js"><link rel="prefetch" href="/assets/js/86.95335038.js"><link rel="prefetch" href="/assets/js/87.df3009dd.js"><link rel="prefetch" href="/assets/js/88.144d6828.js"><link rel="prefetch" href="/assets/js/9.68dd9b41.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a068838e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/mrzhenggang/CDN@master/avatar/avatar.png" alt="Mr.ZhengGang's blog" class="logo"> <span class="site-name can-hide">Mr.ZhengGang's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="用户手册" class="dropdown-title"><!----> <span class="title" style="display:;">用户手册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/user-manual/th1a/" class="nav-link">天河一号</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软件中心" class="dropdown-title"><a href="/software/" class="link-title">软件中心</a> <span class="title" style="display:none;">软件中心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/the-most-basic-introduction-to-compilation/" class="nav-link">01.编译环境</a></li><li class="dropdown-item"><!----> <a href="/fftw/" class="nav-link">02.基础库</a></li><li class="dropdown-item"><!----> <a href="/alamode/" class="nav-link">03.应用软件</a></li><li class="dropdown-item"><!----> <a href="/collectl/" class="nav-link">04.工具软件</a></li><li class="dropdown-item"><!----> <a href="/co-array-fortran/" class="nav-link">05.常用语言环境</a></li><li class="dropdown-item"><!----> <a href="/how-to-add-a-new-potential-function-form-to-lammps/" class="nav-link">06.使用进阶</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程中心" class="dropdown-title"><a href="/supercomputer-courses/" class="link-title">课程中心</a> <span class="title" style="display:none;">课程中心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>入门课程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/supercomputer-courses/history-40-years/" class="nav-link">01.超算历史</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/vpn/" class="nav-link">02.VPN登录</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/ssh-sftp-mobaxterm/" class="nav-link">03.Mobaxterm工具</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/linux-basic-commands/" class="nav-link">04.Linux基本命令</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/module/" class="nav-link">05.Module环境变量管理工具</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/vim/" class="nav-link">06.Vim文本编辑器使用</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/slurm/" class="nav-link">07.Slurm作业管理系统</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><a href="/faqs/" class="link-title">常见问题</a> <span class="title" style="display:none;">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/faqs/login-summary/" class="nav-link">01.登录问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/compile-summary/" class="nav-link">02.编译问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/job-summary/" class="nav-link">03.作业问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/storage-data-summary/" class="nav-link">04.存储和数据问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/gpu-summary/" class="nav-link">05.GPU问题</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">💖联系</a></div><div class="nav-item"><a href="/trial/" class="nav-link">🚀试用</a></div> <a href="https://github.com/mrzhenggang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="用户手册" class="dropdown-title"><!----> <span class="title" style="display:;">用户手册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/user-manual/th1a/" class="nav-link">天河一号</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软件中心" class="dropdown-title"><a href="/software/" class="link-title">软件中心</a> <span class="title" style="display:none;">软件中心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/the-most-basic-introduction-to-compilation/" class="nav-link">01.编译环境</a></li><li class="dropdown-item"><!----> <a href="/fftw/" class="nav-link">02.基础库</a></li><li class="dropdown-item"><!----> <a href="/alamode/" class="nav-link">03.应用软件</a></li><li class="dropdown-item"><!----> <a href="/collectl/" class="nav-link">04.工具软件</a></li><li class="dropdown-item"><!----> <a href="/co-array-fortran/" class="nav-link">05.常用语言环境</a></li><li class="dropdown-item"><!----> <a href="/how-to-add-a-new-potential-function-form-to-lammps/" class="nav-link">06.使用进阶</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程中心" class="dropdown-title"><a href="/supercomputer-courses/" class="link-title">课程中心</a> <span class="title" style="display:none;">课程中心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>入门课程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/supercomputer-courses/history-40-years/" class="nav-link">01.超算历史</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/vpn/" class="nav-link">02.VPN登录</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/ssh-sftp-mobaxterm/" class="nav-link">03.Mobaxterm工具</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/linux-basic-commands/" class="nav-link">04.Linux基本命令</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/module/" class="nav-link">05.Module环境变量管理工具</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/vim/" class="nav-link">06.Vim文本编辑器使用</a></li><li class="dropdown-subitem"><a href="/supercomputer-courses/slurm/" class="nav-link">07.Slurm作业管理系统</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><a href="/faqs/" class="link-title">常见问题</a> <span class="title" style="display:none;">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/faqs/login-summary/" class="nav-link">01.登录问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/compile-summary/" class="nav-link">02.编译问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/job-summary/" class="nav-link">03.作业问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/storage-data-summary/" class="nav-link">04.存储和数据问题</a></li><li class="dropdown-item"><!----> <a href="/faqs/gpu-summary/" class="nav-link">05.GPU问题</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">💖联系</a></div><div class="nav-item"><a href="/trial/" class="nav-link">🚀试用</a></div> <a href="https://github.com/mrzhenggang/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>编译环境</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/the-most-basic-introduction-to-compilation/" class="sidebar-link">编译入门</a></li><li><a href="/gcc/" class="sidebar-link">gcc</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基础库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fftw/" class="sidebar-link">fftw</a></li><li><a href="/petsc/" aria-current="page" class="active sidebar-link">petsc</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/petsc/#什么是petsc" class="sidebar-link">什么是PETSc</a></li><li class="sidebar-sub-header"><a href="/petsc/#安装最基础环境" class="sidebar-link">安装最基础环境</a></li><li class="sidebar-sub-header"><a href="/petsc/#安装扩展包" class="sidebar-link">安装扩展包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/petsc/#寻找包名" class="sidebar-link">寻找包名</a></li><li class="sidebar-sub-header"><a href="/petsc/#安装扩展包-2" class="sidebar-link">安装扩展包</a></li></ul></li><li class="sidebar-sub-header"><a href="/petsc/#测试" class="sidebar-link">测试</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>应用软件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alamode/" class="sidebar-link">alamode</a></li><li><a href="/angsd/" class="sidebar-link">angsd</a></li><li><a href="/software/beast/" class="sidebar-link">beast</a></li><li><a href="/berkeleygw/" class="sidebar-link">berkeleygw</a></li><li><a href="/comsol/" class="sidebar-link">comsol</a></li><li><a href="/cp2k/" class="sidebar-link">cp2k</a></li><li><a href="/gromacs/" class="sidebar-link">gromacs</a></li><li><a href="/jfeff/" class="sidebar-link">jfeff</a></li><li><a href="/lammps/" class="sidebar-link">lammps</a></li><li><a href="/mitgcm/" class="sidebar-link">mitgcm</a></li><li><a href="/molpro/" class="sidebar-link">molpro</a></li><li><a href="/nciplot/" class="sidebar-link">nciplot</a></li><li><a href="/ovito/" class="sidebar-link">ovito</a></li><li><a href="/swash/" class="sidebar-link">swash</a></li><li><a href="/uv-cdat/" class="sidebar-link">uv-cdat</a></li><li><a href="/vasp/" class="sidebar-link">vasp</a></li><li><a href="/wrf/" class="sidebar-link">wrf</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工具软件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/citrix/" class="sidebar-link">citrix</a></li><li><a href="/tacc-launcher/" class="sidebar-link">tacc-launcher</a></li><li><a href="/slurm/" class="sidebar-link">slurm</a></li><li><a href="/collectl/" class="sidebar-link">collectl</a></li><li><a href="/winscp/" class="sidebar-link">winscp</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>常用语言环境</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/co-array-fortran/" class="sidebar-link">Co-Array Fortran 使用说明</a></li><li><a href="/anaconda/" class="sidebar-link">python集成环境anaconda</a></li><li><a href="/python-package-install-with-pip/" class="sidebar-link">python扩展包安装(pip方式)</a></li><li><a href="/python-package-install/" class="sidebar-link">python扩展包安装</a></li><li><a href="/python-package-install-with-conda/" class="sidebar-link">python扩展包安装(conda方式)</a></li><li><a href="/r/" class="sidebar-link">R编译安装</a></li><li><a href="/r-package-install/" class="sidebar-link">R扩展包安装</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>使用进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/how-to-add-a-new-potential-function-form-to-lammps/" class="sidebar-link">lammps添加自定义势函数</a></li><li><a href="/ms-task-submit-script/" class="sidebar-link">MaterialsStudio任务提交脚本详解</a></li><li><a href="/how-to-compile-namd-on-arm-platform/" class="sidebar-link">namd在ARM平台安装</a></li><li><a href="/vasp-fixed-cell-direction-no-optimize/" class="sidebar-link">vasp固定晶胞方向不优化</a></li><li><a href="/editor-enhancements-for-use-with-NCL-scripts/" class="sidebar-link">设置编辑器语法高亮支持NCL</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1b7c64bb><div class="articleInfo" data-v-1b7c64bb><ul class="breadcrumbs" data-v-1b7c64bb><li data-v-1b7c64bb><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1b7c64bb></a></li> <li data-v-1b7c64bb><a href="/software" title="软件中心-目录页" data-v-1b7c64bb>软件中心</a></li> <li data-v-1b7c64bb><a href="/software/#基础库" title="软件中心#基础库" data-v-1b7c64bb>基础库</a></li></ul> <div class="info" data-v-1b7c64bb><div title="作者" class="author iconfont icon-touxiang" data-v-1b7c64bb><a href="https://github.com/mrzhenggang" target="_blank" title="作者" class="beLink" data-v-1b7c64bb>ZhengGang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1b7c64bb><a href="javascript:;" data-v-1b7c64bb>2017-10-10</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          PETSc 编译安装教程
        </h1> <div class="theme-vdoing-content content__default"><h2 id="什么是petsc"><a href="#什么是petsc" class="header-anchor">#</a> 什么是PETSc</h2> <p>PETSc, pronounced PET-see (the S is silent), is a suite of data structures and routines for the scalable (parallel) solution of scientific applications modeled by partial differential equations. It supports MPI, and GPUs through CUDA or OpenCL, as well as hybrid MPI-GPU parallelism.</p> <p>英文版安装说明可参考官网：
https://www.mcs.anl.gov/petsc/documentation/installation.html#exampleusage</p> <p>因为安装PETSc可以有很多很多扩展包，所以我们在共享目录下只安装了基础的几个扩展，用户有需求的可以自行下载安装自己需要的扩展包。下面先介绍安装最基础的包，然后说明如何安装扩展包。</p> <h2 id="安装最基础环境"><a href="#安装最基础环境" class="header-anchor">#</a> 安装最基础环境</h2> <p>最基础的编译环境包括：</p> <ul><li>编译器 Intel Compiler 或 GNU Compiler</li> <li>MPI编译器：如mpich等</li> <li>BLAS/LAPACK库：如使用netlib的lapack，或者fblaslapack，或者Intel的MKL库</li></ul> <p>举例如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 下载一个petsc的包，如无特殊需求，可以下载lite版，小一点
# 下载地址：https://www.mcs.anl.gov/petsc/download/index.html

cd ~ # 进入用户根目录
tar zxvf petsc-lite-3.14.1.tar.gz
cd petsc-lite-3.14.1

# 加载编译环境（Intel Compiler + MPI库）
module add Intel_compiler/13.0
module add MPI/mpich/intel2013
module add mkl/13.0.0
module add cmake/3.14.4

# configure
./configure prefix=$HOME/software/petsc/3.14.1-icc13-mpich \
	--with-cc=mpicc --with-cxx=mpicxx --with-fc=mpif90 \
	--with-mpiexec=/usr/bin/yhrun \
	--with-blas-lapack-dir=$MKLROOT 

# make
make PETSC_DIR=$HOME/petsc-3.14.1 PETSC_ARCH=arch-linux2-c-debug

# make install
make PETSC_DIR=$HOME/petsc-3.14.1 PETSC_ARCH=arch-linux2-c-debug install 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">建议</p> <ol><li>官网介绍有很多种情况下的配置说明，推荐阅读</li> <li>默认是debug版本，如果希望获得opt版本，请添加configure的参数 <code>--with-debugging=0</code></li></ol></div> <h2 id="安装扩展包"><a href="#安装扩展包" class="header-anchor">#</a> 安装扩展包</h2> <p>PETSc添加扩展的方式有2中：</p> <ol><li>通过 <code>--with-xx-dir</code> 的方式指定已经安装过的目录</li> <li>通过 <code>--download-xx</code> 的方式自动下载包并编译安装（需要联网）</li> <li>通过 <code>--download-xx=/path/to/package.tar.gz</code> 指定安装包的路径，扩展包可以去https://ftp.mcs.anl.gov/pub/petsc/externalpackages/下载</li></ol> <p>我们在平台上已经将<code>https://ftp.mcs.anl.gov/pub/petsc/externalpackages/</code>网址下的包下载到的系统目录（定期会更新），<code>TH-1A</code>集群用户的目录为<code>/vol-th/software/petsc/externalpackages</code>，用户可以自行指定该目录。</p> <p>我们尝试安装几个扩展包吧，比如：</p> <ul><li>fblaslapack</li> <li>fftw</li> <li>hdf5</li> <li>netcdf</li> <li>metis</li></ul> <h3 id="寻找包名"><a href="#寻找包名" class="header-anchor">#</a> 寻找包名</h3> <p>寻找包名有2个方式：</p> <p>简单的方式，前往系统目录找一个比较新的。例如<code>fftw</code>，我们前往<code>/vol-th/software/petsc/externalpackages</code> 目录，使用如<code>ls | grep fftw</code>命令，找到包：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>fftw-3.1.1.tar.gz
fftw-3.1.2.tar.gz
fftw-3.2alpha2.tar.gz
fftw-3.2alpha3.tar.gz
fftw-3.3.2.tar.gz
fftw-3.3.3.tar.gz
fftw-3.3.7.tar.gz
fftw-3.3.8.tar.gz
fftw-3.3alpha1.tar.gz
fftw-3.3-beta1.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>我们可以选用如最新的<code>fftw-3.3.8.tar.gz</code>包。</p> <p>其他的包：</p> <ul><li>fblaslapack : fblaslapack-3.4.2.tar.gz</li> <li>hdf5 : hdf5-1.12.0.tar.bz2</li> <li>netcdf : netcdf-4.5.0.tar.gz</li> <li>metis : metis-5.1.0-p3.tar.gz</li></ul> <p>第二种，可以在petsc源码包的目录，找到该版本的对应的库版本。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 进入用户根目录</span>
<span class="token builtin class-name">cd</span> ~
<span class="token comment"># 解压缩</span>
<span class="token function">tar</span> zxvf petsc-lite-3.14.1.tar.gz
<span class="token comment"># 进入压缩包</span>
<span class="token builtin class-name">cd</span> petsc-lite-3.14.1
<span class="token comment"># 进入指定目录</span>
<span class="token builtin class-name">cd</span> config/BuildSystem/config/packages
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这个目录下有各个包的下载方式和版本，例如fftw库，我们使用<code>ls</code>查看全部文件，再找到<code>fftw.py</code>文件，或者使用<code>ls | grep fftw</code>找到<code>fftw.py</code> 文件。</p> <p>我们打开这个文件：<code>vim fftw.py</code>，内容如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">import</span> config.package

class Configure<span class="token punctuation">(</span>config.package.GNUPackage<span class="token punctuation">)</span>:
  def __init__<span class="token punctuation">(</span>self, framework<span class="token punctuation">)</span>:
    config.package.GNUPackage.__init__<span class="token punctuation">(</span>self, framework<span class="token punctuation">)</span>
    <span class="token comment"># host locally as fftw.org url can expire after new release.</span>
    self.download   <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://www.fftw.org/fftw-3.3.8.tar.gz'</span>,
                       <span class="token string">'http://ftp.mcs.anl.gov/pub/petsc/externalpackages/fftw-3.3.8.tar.gz'</span><span class="token punctuation">]</span>
    self.functions  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'fftw_malloc'</span>,<span class="token string">'fftw_mpi_cleanup'</span><span class="token punctuation">]</span>
    self.includes   <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'fftw3-mpi.h'</span><span class="token punctuation">]</span>
    self.liblist    <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'libfftw3_mpi.a'</span>,<span class="token string">'libfftw3.a'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    self.pkgname    <span class="token operator">=</span> <span class="token string">'fftw3'</span>
    self.precisions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'double'</span><span class="token punctuation">]</span>
    <span class="token builtin class-name">return</span>
<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>可以看到这个版本的petsc库自动关联的fftw库<code>fftw-3.3.8.tar.gz</code>，我们前往<code>/vol-th/software/petsc/externalpackages</code>，寻找到这个文件即可。</p> <p>其他的包：</p> <ul><li>fblaslapack : fblaslapack-v3.4.2-p3.tar.gz</li> <li>hdf5 : hdf5-1.12.0.tar.bz2</li> <li>netcdf : netcdf-4.5.0.tar.gz</li> <li>metis : metis-5.1.0-p3.tar.gz</li></ul> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>如果在/vol-th/software/petsc/externalpackages目录没有找到你希望的包，那么可以根据对应的py文件的路径，自行下载压缩包，传到自己账号目录下，并在接下来的路径设置时，配置为自己的路径</p></div> <h3 id="安装扩展包-2"><a href="#安装扩展包-2" class="header-anchor">#</a> 安装扩展包</h3> <p>注意给出扩展包的路径即可</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 进入用户根目录</span>
<span class="token builtin class-name">cd</span> ~ 
<span class="token comment"># 如果之前没有解压缩过</span>
<span class="token function">tar</span> zxvf petsc-lite-3.14.1.tar.gz
<span class="token builtin class-name">cd</span> petsc-lite-3.14.1

<span class="token comment"># 加载编译环境（GNU Compiler + MPI库）</span>
module <span class="token function">add</span> GCC/4.9.4
module <span class="token function">add</span> MPI/mpich/gcc4.9.4
module <span class="token function">add</span> cmake/3.14.4

<span class="token comment"># configure</span>
./configure <span class="token assign-left variable">prefix</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/software/petsc/3.14.1-gcc49-mpich <span class="token punctuation">\</span>
	--with-cc<span class="token operator">=</span>mpicc --with-cxx<span class="token operator">=</span>mpicxx --with-fc<span class="token operator">=</span>mpif90 <span class="token punctuation">\</span>
	--with-mpiexec<span class="token operator">=</span>/usr/bin/yhrun <span class="token punctuation">\</span>
	--download-fblaslapack<span class="token operator">=</span>/vol-th/software/petsc/externalpackages/fblaslapack-3.4.2.tar.gz <span class="token punctuation">\</span>
	--download-fftw<span class="token operator">=</span>/vol-th/software/petsc/externalpackages/fftw-3.3.8.tar.gz <span class="token punctuation">\</span>
	--download-hdf5<span class="token operator">=</span>/vol-th/software/petsc/externalpackages/hdf5-1.12.0.tar.bz2 <span class="token punctuation">\</span>
	--download-netcdf<span class="token operator">=</span>/vol-th/software/petsc/externalpackages/netcdf-4.5.0.tar.gz <span class="token punctuation">\</span>
	--download-metis<span class="token operator">=</span>/vol-th/software/petsc/externalpackages/metis-5.1.0-p3.tar.gz <span class="token punctuation">\</span>
	--with-debugging<span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">\</span>
	<span class="token assign-left variable">COPTFLAGS</span><span class="token operator">=</span><span class="token string">&quot;-O3&quot;</span> <span class="token punctuation">\</span>
	<span class="token assign-left variable">CXXOPTFLAGS</span><span class="token operator">=</span><span class="token string">&quot;-O3&quot;</span> <span class="token punctuation">\</span>
	<span class="token assign-left variable">FOPTFLAGS</span><span class="token operator">=</span><span class="token string">&quot;-O3&quot;</span>

<span class="token comment"># make</span>
<span class="token function">make</span> <span class="token assign-left variable">PETSC_DIR</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/petsc-3.14.1 <span class="token assign-left variable">PETSC_ARCH</span><span class="token operator">=</span>arch-linux2-c-opt

<span class="token comment"># make install</span>
<span class="token function">make</span> <span class="token assign-left variable">PETSC_DIR</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/petsc-3.14.1 <span class="token assign-left variable">PETSC_ARCH</span><span class="token operator">=</span>arch-linux2-c-opt <span class="token function">install</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">建议</p> <p>优先推荐使用Intel Compiler + 系统自带MPI + MKL库，这样速度快强烈不建议通过PETSc自行编译mpi，因为使用系统的MPI速度快</p></div> <h2 id="测试"><a href="#测试" class="header-anchor">#</a> 测试</h2> <p>配置环境（以刚刚使用gcc4.9.4编译的为例）</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>module <span class="token function">add</span> GCC/4.9.4
module <span class="token function">add</span> MPI/mpich/gcc4.9.4
<span class="token builtin class-name">export</span> <span class="token assign-left variable">PETSC_DIR</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/petsc-3.14.1 
<span class="token builtin class-name">export</span> <span class="token assign-left variable">PETSC_ARCH</span><span class="token operator">=</span>arch-linux2-c-opt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>进入算例目录编译并运行</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> ~/petsc-3.14.1/src/ksp/ksp/examples/tutorials

<span class="token comment"># 编译</span>
<span class="token function">make</span> ex50

<span class="token comment"># 运行</span>
./ex50  -da_grid_x <span class="token number">4</span> -da_grid_y <span class="token number">4</span> -mat_view
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></div> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/fftw/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">fftw</div></a> <a href="/alamode/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">alamode</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/fftw/" class="prev">fftw</a></span> <span class="next"><a href="/alamode/">alamode</a>→
      </span></p></div></div></div> <!----> </main></div> <div class="footer"><div class="icons"><a href="mailto:mrzhenggang@nscc-tj.cn" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/mrzhenggang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=153349579" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2018-2020
    <span>Zheng Gang | <a href="https://github.com/mrzhenggang/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a> | <a href="http://www.beian.gov.cn/">津ICP备17007036号-1</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.69f27ac7.js" defer></script><script src="/assets/js/2.6c62b168.js" defer></script><script src="/assets/js/27.28b186b5.js" defer></script>
  </body>
</html>